<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PVLens - Drug Safety Dashboard</title>

    <!-- Google Fonts - Outfit -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="css/pvlens.css">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="images/favicon.svg">
</head>
<body>
    <div class="app-container">
        <!-- Header Navigation -->
        <header class="header">
            <div class="header-left">
                <a href="#" class="logo" data-page="overview">
                    <svg class="logo-icon" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="40" height="40" rx="12" fill="#76FB91"/>
                        <path d="M20 10L28 18L20 26L12 18L20 10Z" fill="#000"/>
                        <circle cx="20" cy="18" r="3" fill="#76FB91"/>
                    </svg>
                    <span class="logo-text">PVLens</span>
                </a>

                <nav class="main-nav">
                    <a href="#" class="nav-link active" data-page="overview">
                        Overview
                    </a>
                    <a href="#" class="nav-link" data-page="substances">
                        Substances
                    </a>
                    <a href="#" class="nav-link" data-page="adverse-events">
                        Adverse Events
                    </a>
                    <a href="#" class="nav-link" data-page="indications">
                        Indications
                    </a>
                </nav>
            </div>
            <div class="header-right">
                <div class="db-status" id="db-status">
                    <span class="status-dot"></span>
                    <span>Checking...</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Overview Page -->
            <div id="page-overview" class="page active">
                <div class="dashboard">
                    <!-- Dashboard Header -->
                    <div class="dashboard-header">
                        <div class="dashboard-title-section">
                            <h1 class="dashboard-title">PVLens Dashboard</h1>
                            <span class="dashboard-subtitle">Drug Safety Data Overview</span>
                        </div>
                    </div>

                    <!-- Stats Cards Row -->
                    <div class="stats-grid">
                        <!-- Substances Card -->
                        <div class="stat-card">
                            <div class="stat-header">
                                <svg class="stat-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 21V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v16"/>
                                    <path d="M9 3v4"/>
                                    <path d="M15 3v4"/>
                                    <path d="M9 14h6"/>
                                    <path d="M9 18h6"/>
                                </svg>
                                <span>Total Substances</span>
                            </div>
                            <div class="stat-main">
                                <span class="stat-value" id="stat-substances">-</span>
                            </div>
                            <div class="stat-breakdown">
                                <div class="breakdown-item">
                                    <span class="breakdown-value" id="stat-prescription">-</span>
                                    <span class="breakdown-label">Prescription</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-value" id="stat-otc">-</span>
                                    <span class="breakdown-label">OTC</span>
                                </div>
                            </div>
                            <a href="#" class="stat-link" data-page="substances">
                                View All Substances
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"/>
                                </svg>
                            </a>
                        </div>

                        <!-- Adverse Events Card -->
                        <div class="stat-card">
                            <div class="stat-header">
                                <svg class="stat-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                    <line x1="12" y1="9" x2="12" y2="13"/>
                                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                                </svg>
                                <span>Adverse Events</span>
                            </div>
                            <div class="stat-main">
                                <span class="stat-value" id="stat-adverse-events">-</span>
                            </div>
                            <div class="stat-breakdown">
                                <div class="breakdown-item">
                                    <span class="breakdown-value" id="stat-blackbox">-</span>
                                    <span class="breakdown-label">Black Box</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-value" id="stat-warnings">-</span>
                                    <span class="breakdown-label">Warnings</span>
                                </div>
                            </div>
                            <a href="#" class="stat-link" data-page="adverse-events">
                                View All Events
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"/>
                                </svg>
                            </a>
                        </div>

                        <!-- Indications Card -->
                        <div class="stat-card">
                            <div class="stat-header">
                                <svg class="stat-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                    <polyline points="22 4 12 14.01 9 11.01"/>
                                </svg>
                                <span>Indications</span>
                            </div>
                            <div class="stat-main">
                                <span class="stat-value" id="stat-indications">-</span>
                            </div>
                            <div class="stat-breakdown">
                                <div class="breakdown-item">
                                    <span class="breakdown-value" id="stat-exact">-</span>
                                    <span class="breakdown-label">Exact Match</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-value" id="stat-nlp">-</span>
                                    <span class="breakdown-label">NLP Match</span>
                                </div>
                            </div>
                            <a href="#" class="stat-link" data-page="indications">
                                View All Indications
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"/>
                                </svg>
                            </a>
                        </div>
                    </div>

                    <!-- Recent Activity Section -->
                    <div class="activity-grid">
                        <!-- Recent Substances -->
                        <div class="activity-card">
                            <div class="activity-header">
                                <h3 class="activity-title">Recent Substances</h3>
                                <a href="#" class="activity-link" data-page="substances">View All</a>
                            </div>
                            <div class="activity-list" id="recent-substances">
                                <div class="empty-state">Loading...</div>
                            </div>
                        </div>

                        <!-- Recent Adverse Events -->
                        <div class="activity-card">
                            <div class="activity-header">
                                <h3 class="activity-title">Recent Adverse Events</h3>
                                <a href="#" class="activity-link" data-page="adverse-events">View All</a>
                            </div>
                            <div class="activity-list" id="recent-adverse-events">
                                <div class="empty-state">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Substances Page -->
            <div id="page-substances" class="page">
                <div class="page-container">
                    <div class="page-header">
                        <div class="page-title-section">
                            <span class="page-subtitle">Drug Products Database</span>
                            <h1 class="page-title">Substances</h1>
                        </div>
                        <div class="page-stats">
                            <span class="page-stat" id="substances-count">- total substances</span>
                        </div>
                    </div>

                    <div class="filters-bar">
                        <div class="search-field">
                            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="M21 21l-4.35-4.35"/>
                            </svg>
                            <input type="text" id="substance-search" class="search-input" placeholder="Search by name, NDC code...">
                        </div>
                        <select id="substance-type" class="filter-select">
                            <option value="all">All Types</option>
                            <option value="PRESCRIPTION">Prescription</option>
                            <option value="OTC">OTC</option>
                            <option value="OTHER">Other</option>
                        </select>
                    </div>

                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Drug Name</th>
                                    <th>Type</th>
                                    <th>Sponsor</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="substances-table">
                                <tr><td colspan="4" class="loading">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="substances-pagination" class="pagination"></div>
                </div>
            </div>

            <!-- Adverse Events Page -->
            <div id="page-adverse-events" class="page">
                <div class="page-container">
                    <div class="page-header">
                        <div class="page-title-section">
                            <span class="page-subtitle">Safety-related adverse events from drug labels</span>
                            <h1 class="page-title">Adverse Events</h1>
                        </div>
                        <div class="page-stats">
                            <span class="page-stat" id="ae-count">- total events</span>
                        </div>
                    </div>

                    <div class="filters-bar">
                        <div class="search-field">
                            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="M21 21l-4.35-4.35"/>
                            </svg>
                            <input type="text" id="ae-search" class="search-input" placeholder="Search adverse events...">
                        </div>
                        <select id="ae-severity" class="filter-select">
                            <option value="all">All Severities</option>
                            <option value="blackbox">Black Box Warning</option>
                            <option value="warning">Warning</option>
                            <option value="standard">Standard</option>
                        </select>
                    </div>

                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>MedDRA Term</th>
                                    <th>Substance</th>
                                    <th>Severity</th>
                                    <th>Match Type</th>
                                </tr>
                            </thead>
                            <tbody id="adverse-events-table">
                                <tr><td colspan="4" class="loading">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="ae-pagination" class="pagination"></div>
                </div>
            </div>

            <!-- Indications Page -->
            <div id="page-indications" class="page">
                <div class="page-container">
                    <div class="page-header">
                        <div class="page-title-section">
                            <span class="page-subtitle">Drug indications from product labels</span>
                            <h1 class="page-title">Indications</h1>
                        </div>
                        <div class="page-stats">
                            <span class="page-stat" id="ind-count">- total indications</span>
                        </div>
                    </div>

                    <div class="filters-bar">
                        <div class="search-field">
                            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="M21 21l-4.35-4.35"/>
                            </svg>
                            <input type="text" id="ind-search" class="search-input" placeholder="Search indications...">
                        </div>
                    </div>

                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>MedDRA Term</th>
                                    <th>Substance</th>
                                    <th>Match Type</th>
                                </tr>
                            </thead>
                            <tbody id="indications-table">
                                <tr><td colspan="3" class="loading">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="ind-pagination" class="pagination"></div>
                </div>
            </div>

            <!-- Substance Detail Modal -->
            <div id="substance-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="modal-title">Substance Details</h2>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body" id="modal-body">
                        <div class="loading">Loading...</div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>PVLens - Pharmacovigilance Dashboard | <a href="https://github.com/adrhito/pvlens" target="_blank">Source</a></p>
        </footer>
    </div>

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
